{% extends 'base.html' %}

{% block title %}
Редактирование статьи
{% endblock %}

{% block content %}
<div class="container">
	<h1>Редактирование статьи</h1>
	<p>Измените данные статьи</p>

	{% with messages = get_flashed_messages(with_categories=true) %}
	{% if messages %}
	{% for category, message in messages %}
	<div class="alert alert-{{ 'success' if category == 'success' else 'danger' }} alert-dismissible fade show"
		role="alert">
		{{ message }}
		<button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
	</div>
	{% endfor %}
	{% endif %}
	{% endwith %}

	<form name="edit_article" method="POST">
		<div class="form-list">
			<div class="mb-3">
				<label class="form-label">Заголовок статьи:</label>
				<input class="form-control {% if errors and errors.title %}is-invalid{% endif %}" type="text"
					name="title" maxlength="200" value="{{ article.title if article else (title if title else '') }}">
				{% if errors and errors.title %}
				<div class="invalid-feedback d-block">{{ errors.title }}</div>
				{% endif %}
			</div>
			<div class="mb-3">
				<label class="form-label">Текст статьи:</label>
				<textarea class="form-control {% if errors and errors.text %}is-invalid{% endif %}" name="text"
					rows="10">{{ article.text if article else (text if text else '') }}</textarea>
				{% if errors and errors.text %}
				<div class="invalid-feedback d-block">{{ errors.text }}</div>
				{% endif %}
			</div>
			<div class="mb-3">
				<button type="submit" class="btn btn-primary">Сохранить изменения</button>
				<a href="{{ url_for('news', id=article.id) }}" class="btn btn-secondary">Отмена</a>
			</div>
		</div>
	</form>

	<div class="mt-5 pt-4 border-top">
		<h5>Опасная зона</h5>
		<p class="text-muted">Удаление статьи невозможно отменить</p>
		<form action="{{ url_for('delete_article', id=article.id) }}" method="POST"
			onsubmit="return confirm('Вы уверены, что хотите удалить эту статью?')">
			<button type="submit" class="btn btn-danger">Удалить статью</button>
		</form>
	</div>
</div>
{% endblock %}